<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style> body {padding: 0; margin: 0;} canvas {vertical-align: top;} </style>
</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.22/p5.min.js"></script>
<script>

// Based on Raphael Schaad's work: https://gist.github.com/raphaelschaad/8b2b3583051682f628ef

"use strict";

class Point {
  constructor(x, y) {
    this.x = x;
    this.y = y;
  }
}

class Stroke {
  constructor(points) {
    this.points = points ? points : [];
  }
  addPoint(point) {
    this.points.push(point);
  }
}

var strokes = [];

function setup() {
  createCanvas(windowWidth, windowHeight);
  colorMode(RGB, 1);
}

function draw() {
  background(0.97);
  strokes.forEach(currentStroke => {
    push();
    {
      noFill();
      stroke('black');
      strokeWeight(3);
      beginShape();
        currentStroke.points.forEach(point => {
          curveVertex(point.x, point.y)
        });
      endShape();
    }
    pop();
  });
}

function getStrokes() {
    jQuery.getJSON("/api/strokes", function(data) {
        strokes = data.strokes;
    })
}

getStrokes()
setInterval(getStrokes, 5000);


</script>
</body>
</html>
